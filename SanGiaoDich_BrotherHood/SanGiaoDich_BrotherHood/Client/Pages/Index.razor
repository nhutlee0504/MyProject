@page "/"
@using SanGiaoDich_BrotherHood.Shared.Models
@inject HttpClient httpClient
@inject NavigationManager NavigationManager
<style>

    .banner, .features-card, .product-grid, .content-card {
        width: 100%;
        margin: 0 auto;
        padding: 0;
    }

    .offer-section {
        background-image: url('/AnhGiaoDien/anhuudai.jpg');
        background-size: cover;
        background-position: center;
        padding: 40px 20px;
        color: #28a745;
        border-radius: 10px;
        text-align: center;
        position: relative;
        overflow: hidden;
    }

        .offer-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.6);
            border-radius: 10px;
            z-index: 1;
        }

    .offer-section-content {
        position: relative;
        z-index: 2;
        max-width: 600px;
        margin: 0 auto;
    }

    .offer-section h2 {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 10px;
        color: #28a745;
    }

    .offer-section p {
        font-size: 1.1rem;
        margin-bottom: 20px;
        color: #28a745;
    }

    .offer-section .input-group {
        width: 100%;
        max-width: 600px; /* Chiều rộng tối đa của input group */
        margin: 0 auto;
    }

    .offer-section .form-control {
        border-radius: 25px; /* Bo góc input để mềm mại hơn */
        border: 1px solid #28a745;
        padding: 12px 20px; /* Thay đổi padding để tăng chiều cao */
        font-size: 1rem;
        color: #28a745;
        outline: none;
        transition: border-color 0.3s ease; /* Thêm hiệu ứng chuyển đổi cho border */
        width: 100%; /* Chiều rộng đầy đủ của input */
    }

        .offer-section .form-control:focus {
            border-color: #218838;
        }

    .offer-section .btn-register {
        border-radius: 25px;
        background-color: #28a745;
        border: none;
        padding: 12px 25px;
        font-size: 1rem;
        color: white;
        transition: background-color 0.3s ease;
    }

        .offer-section .btn-register:hover {
            background-color: #218838;
        }

    .offer-section .input-group-text {
        background-color: white;
        border: 1px solid #28a745;
        border-radius: 25px 0 0 25px;
    }
    /* Carousel */
    .carousel-item img {
        width: 100%;
        height: auto;
    }

    /* Feature section */
    .features-card {
        width: 100%;
        margin: 20px auto;
        background-color: #fff;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .features {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin: 0;
        padding: 20px 0;
        background-color: #fff;
    }

    .feature-item {
        display: flex;
        align-items: center;
        border-radius: 8px;
        padding: 15px;
        text-align: left;
    }

        .feature-item i {
            font-size: 36px;
            margin-right: 15px;
        }

    .feature-text p {
        font-weight: bold;
        margin: 0;
        color: #333;
    }

    .feature-text span {
        display: block;
        font-size: 14px;
        color: #555;
    }


    .load-more {
        text-align: center;
        margin-top: 20px;
    }

        .load-more a {
            display: inline-block;
            font-size: 18px;
            color: #007bff;
            text-decoration: none;
            margin-bottom: 10px;
        }

        .load-more i {
            display: block;
            font-size: 24px;
            color: #007bff;
        }

    .product-name {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 200px;
    }

    .banner-advertisement {
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .banner-image img {
        border-radius: 8px;
    }

    .banner-content h4 {
        font-weight: bold;
    }

    .banner-content ul {
        padding-left: 1.5rem;
        margin-top: 1rem;
    }

    .banner-content li {
        font-size: 0.95rem;
        margin-bottom: 0.5rem;
    }

</style>
<div class="row">
    <div class="col-md-12">
        <section class="banner">
            <!-- Carousel -->
            <div id="carouselExampleAutoplaying" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <!-- Image with no mask -->
                        <div class="bg-image">
                            <img src="/AnhGiaoDien/jordan-2.webp" class="img-fluid w-100" alt="Logo">
                        </div>
                    </div>
                    <div class="carousel-item">
                        <!-- Image with no mask -->
                        <div class="bg-image">
                            <img src="/AnhGiaoDien/chup_hinh_san_pham_ao_thun_namnu.jpg" class="img-fluid w-100" alt="Logo">
                        </div>
                    </div>
                    <div class="carousel-item">
                        <!-- Image with no mask -->
                        <div class="bg-image">
                            <img src="/AnhGiaoDien/hinhneniphone14_1280x720-800-resize.jpg" class="img-fluid w-100" alt="Logo">
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </section>
    </div>

    <!-- Features section inside a card -->
    <div class="container">
        <div class="card features-card">
            <div class="row justify-content-center">
                <div class="col-md-3 col-sm-6 d-flex justify-content-center feature-item text-center">
                    <i class="fas fa-shopping-cart"></i>
                    <div class="feature-text">
                        <p>Miễn phí mua sắm</p>
                        <span>Mua sắm thỏa sức</span>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6  d-flex justify-content-center feature-item text-center">
                    <i class="fas fa-exchange-alt"></i>
                    <div class="feature-text">
                        <p>Dễ dàng giao dịch</p>
                        <span>Giao dịch nhanh chóng</span>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6  d-flex justify-content-center feature-item text-center">
                    <i class="fas fa-lock"></i>
                    <div class="feature-text">
                        <p>Bảo mật cao</p>
                        <span>Các thông tin cá nhân được bảo mật tuyệt đối</span>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6  d-flex justify-content-center feature-item text-center">
                    <i class="fas fa-wallet"></i>
                    <div class="feature-text">
                        <p>Ví điện tử</p>
                        <span>Hợp hơn khi sở hữu ví tại hệ thống</span>
                    </div>
                </div>
            </div>
        </div>
    </div>



</div>
<div class="container-fluid banner-advertisement mt-4 mb-4">
    <div class="row align-items-center">
        <!-- Cột trái: Hình ảnh -->
        <div class="col-md-6">
            <div class="banner-image">
                <img src="/AnhGiaoDien/big-sale-50-off-shop-260nw-2494473089.png"
                     alt="Advertisement" class="img-fluid rounded">
            </div>
        </div>

        <!-- Cột phải: Nội dung -->
        <div class="col-md-6">
            <div class="banner-content p-3">
                <h4 class="banner-title text-success">🎉 Chương trình khuyến mãi đặc biệt</h4>
                <p class="banner-description" style="font-size: 1rem;">
                    Chào mừng đến với mùa khuyến mãi lớn! Đăng bài dễ dàng và tiếp cận nhiều khách hàng hơn với chi phí thấp hơn.
                    Hãy tận dụng cơ hội để bán các món đồ cũ của bạn một cách nhanh chóng và hiệu quả.
                </p>
                <ul class="list-unstyled">
                    <li>✅ Giảm phí đăng bài lên tới <strong>50%</strong>.</li>
                    <li>✅ Ưu đãi chỉ trong <strong>7 ngày</strong>.</li>
                    <li>✅ Đơn giản, tiện lợi, hiệu quả cao.</li>
                </ul>
                <p class="banner-text" style="font-size: 0.9rem;">👉 Tham khảo thêm chi tiết và đăng bài ngay tại <a href="/promo-link" class="text-success">đây</a>.</p>
            </div>
        </div>
    </div>
</div>


@code {


    private Dictionary<int, string> categories = new Dictionary<int, string>();
    private List<Product> products = new List<Product>();
    private Dictionary<int, List<string>> productImages = new Dictionary<int, List<string>>();


    protected override async Task OnInitializedAsync()
    {
        try
        {
            products = await httpClient.GetFromJsonAsync<List<Product>>("api/product/GetAllProduct");
            var categoryList = await httpClient.GetFromJsonAsync<List<Category>>("api/category/GetCategories");
            categories = categoryList?.ToDictionary(c => c.IDCategory, c => c.NameCate) ?? new Dictionary<int, string>();
            productImages = new Dictionary<int, List<string>>();
            foreach (var product in products)
            {
                var images = await httpClient.GetFromJsonAsync<List<ImageProduct>>($"api/ImageProduct/GetImageProduct/{product.IDProduct}");
                productImages[product.IDProduct] = images?.Select(img => img.Image).ToList() ?? new List<string>();
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error fetching products, categories, or images: {ex.Message}");
        }
    }

}
<div class="container-fluid mt-4">
    @foreach (var category in categories)
    {
        <div class="row mb-5">
            <!-- Tiêu đề Danh Mục -->
            <div class="col-12 mb-3 d-flex justify-content-between align-items-center">
                <h3 class="text-success fw-bold">
                    @category.Value
                </h3>
                <!-- Nút Xem Thêm -->
                <a href="@($"/DanhMuc/{category.Key}")" class="btn btn-outline-success border-0">
                    Xem thêm
                </a>
            </div>

            <!-- Sản Phẩm Trong Danh Mục -->
            @foreach (var product in products
           .Where(p => p.IDCategory == category.Key && p.Status == "Đã duyệt")
           .OrderByDescending(p => p.ProrityLevel == "Ưu tiên")
           .ThenBy(p => p.Name)
           .Take(4)) // Giới hạn 4 sản phẩm mỗi danh mục
            {
                <div class="col-sm-3 col-6 mb-4 d-flex">
                    <a href="@($"/ChiTietSanPham/{product.IDProduct}")"
                       class="card shadow"
                       style="border-radius: 15px; display: flex; flex-direction: column; height: 100%; border:none; text-decoration: none; color: inherit;">
                        @if (productImages.ContainsKey(product.IDProduct) && productImages[product.IDProduct].Any())
                        {
                            var firstImage = productImages[product.IDProduct].FirstOrDefault();
                            <img class="card-img-top p-3" style="border-radius: 25px;" src="@firstImage" alt="@product.Name" />
                        }
                        else
                        {
                            <img class="card-img-top p-3" style="border-radius: 25px;" src="/AnhSanPham/default.png" alt="No Image Available" />
                        }
                        <div class="card-body">
                            @if (product.ProrityLevel == "Ưu tiên")
                            {
                                <h5 class="fs-5 fw-bold">
                                    <span class="badge text-bg-success" style="background-color: green; padding: 5px 10px;">
                                        @product.ProrityLevel
                                    </span>
                                    <div class="product-name">
                                        @product.Name
                                    </div>
                                </h5>
                            }
                            else
                            {
                                <h5 class="fs-5 fw-bold">
                                    <div class="product-name">
                                        @product.Name
                                    </div>
                                </h5>
                            }
                            <p class="price" style="color:green; font-weight:bolder">@product.Price.ToString("N0") VND</p>
                            <div class="row">
                                <div class="col-md-6 col-6" style="font-style:italic">
                                    <i class="bi bi-tag-fill"></i>
                                    @(categories.ContainsKey(product.IDCategory) ? categories[product.IDCategory] : "Không xác định")
                                </div>
                                <div class="col-md-6 col-6 d-flex justify-content-end" style="color:blue; font-weight:bolder; text-decoration-line:underline">
                                    @product.StartDate?.ToString("dd/MM/yyyy")
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            }
        </div>
    }
</div>

@* <div class="load-more">
    <a href="#">Xem thêm</a>
    <i class='far fa-arrow-alt-circle-down'></i>
</div> *@

<div class="offer-section mb-5">
    <div class="offer-section-content">
        <h2>Nhận ưu đãi đặc biệt từ chúng tôi!</h2>
        <p>Đăng ký nhận tin tức, khuyến mãi từ trang web.</p>
        <div class="input-group">
            <input type="email" class="form-control" placeholder="Nhập email của bạn" aria-label="Email" />
        </div>
        <button class="btn btn-register mt-3">
            <i class="fas fa-paper-plane"></i> Đăng ký
        </button>
    </div>
</div>



<script>
    window.addEventListener('load', function () {
        document.querySelector('.banner-overlay').classList.add('fade-in');
    });

</script>
